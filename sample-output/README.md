# PITFALL

This code is not entirely functional.
Sometimes I have to modify `Colors.color_maps`.
The rainbow cycle must have some length `R = k * edo`,
where k is an integer > 1.
Usually, k = 1. For layouts that require it not to be,
I should add a comment to that effect.
See, for instance, `58edo.8right.5downright` below.

# What these layouts are

## The 31-edo Bosanquet layout

It's called `31edo.5right.3downright.ltn`.
It doesn't do anything the Lumatone's builtin
31-edo Bosanquet layout doesn't do,
but it was a useful proof of concept.

This layout offers the minor advantage of
being readable than that builtin layout,
because each octave is on a separate MIDI channel,
and its MIDI note values lie exclusively in the interval [0,30].

## The 34-edo layout

This is almost flat, and horizontally narrower than Bosanquet
(which does not even exist for 34-edo),
and so the Lumatone yields more than 5 octaves when using it.

It's called `34edo.7right.3downright.ltn`,
and can be generated by running
```
go 34 7 3 0 0
```

## The 41-edo Bosanquet layout

There are two of them, which are equal except for pitch shift.
They have these names:
```
41edo.7right.3downright.+1channels.ltn
41edo.7right.3downright.+9notes.ltn
```

and were generated via these commands:
```
go 41 7 3 0 0
go 41 7 3 9 1
```

If something is hard to play in one of them
(because your hand is up against the top or bottom edge of the keyboard),
it should be easier to play in the other.
(9 EDO steps not always half a keyboard's width --
that depends on both the EDO and the layout.
In the case of 41-edo Bosanquet, it is.)

One of the layouts is shifted 9 MIDI notes and 1 MIDI channel up.
That's so the two layouts are in the same octave.
The reason that's necessary is described in the main README.


## `41edo.6right.-1downright.ltn` is a wide, flat 41-edo layout.

I thought it would be cool. Maybe it is.
I'm happy enough so far with 41-edo's Bosanquet, though,
that I've barely used it, so I won't try to sell you on it.

This also comes in two versions,
equal except that one has been pitch-shifted
by a vertical half of a keyboard.

```
go 41 6 (-1) 0  0
go 41 6 (-1) 22 0
```

## The 46-edo layouts

Both are wider and flatter than Bosanquet,
and slightly diagonal (half a button every octave).

### 4\46 right x 11\46 downright (a.k.a. 4\46 right x 7\46 down)

This layout also comes in three versions,
equivalent except for the amount by which they have been shifted
(which is 14\46, i.e. two vertical spaces,
i.e. roughly 1/3 of the pattern's total height).
Each is called `46edo.4right.11downright.*.ltn`
for some value of `*`.
These are the commands that generated them:

```
go 46 4 11  1 0
go 46 4 11 15 0
go 46 4 11 29 0
```

### 5\46 x 7\46

This is more diagonal (4\46 right x 11\46 downright),
but much less skew.

```
go 46 5 7 0 0
```

## The two 50-edo Bosanquet layouts

Again two versions of the same layout,
shifted by a vertical half of a keyboard.

```
go 50 8 5 0  0
go 50 8 5 20 0
```

## The two 53-edo Bosanquet layouts

Again two versions of the same layout,
shifted by a vertical half of a keyboard.

```
go 53 9 4 0  0
go 53 9 4 11 1
```

# In brief, how I generated the latest data

(The passage below uses "00" instead of "0"
so that it can be sensibly line-sorted in Emacs.)

```
-- go edo right_step downright_step note_shift channel_shift
go 12 4   05  60 00 [] []
go 24 5   04  00 00 [] []

-- 27edo.4right.7downright.black-2-horiz-2-dr.ltn
-- The black markers could be more evenly spaced,
-- but this way they cover more colors, which I think I prefer.
-- TODO : Do I prefer?
go 27 4   07  00 00 [ (color_black, 2, [0,2,23,24] ) ]

go 29 5   02  00 00 [] []

-- 29edo.5right.2downright.rainbow-black-stripe.ltn
go 29 5   02  0  0 [ (color_black, 2, [24,29,35,40] ) ]

-- 31edo.5right.3downright.2-vert.ltn
go 31 5   03  0  0 [ (color_black, 2, [10,15] ) ]

-- 31edo.5right.3downright.2-vert-2-horiz.ltn
go 31 5   03  0  0 [ (color_black, 2, [10,15,36,19 ] ) ]
  -- 36 and 19 are adjacent, if I'm right.
  -- I'd like to write 37 rather than 19, but 37 wraps around.

-- 34edo.3right.11downright.color-7.black-2-horiz-2-vert.ltn
go 34 3   11  00 00 [ (color_black, 2, [0,1, 15,21] ) ]

-- 34edo.7right.3downright.color-5.black-2-horiz-2-vert.ltn
go 34 7   03  00 00 [ (color_black, 2, [0,1, 15,21] ) ]

-- 36edo.5right.3downright.black-2-horiz-2-vert.ltn
go 36 5 3 0 0 [ (color_black, 2, [0,1, 17,23] ) ]

-- 41edo.6right.5downright.color-12.black-2h-2v.ltn
go 41 6 (5)  00 00 [ (color_black, 2, [0,1, 15,21] ) ]

-- 41edo.7right.3downright.black-3-9-36-42.ltn
go 41 7   03  00 00 [ (color_black, 2, [3,9,36,42] ) ]

-- 43edo.7right.4downright.2-vert-2-horiz.ltn
go 43 7   04  0  0 [ (color_black, 2, ( [5,10] ++ [19,25 ] ) ) ]

-- 46edo.5right.2down.2-vert-2-horiz.ltn
-- PITFALL: 5 right 7 downright = 5 right 2 down
-- PITFALL: For this to be readable I need rainbow fifths,
-- i.e. in Colors.hs there should be a passage like
-- (46, rainbow 46 27 46 0)
go 46 5 7 0 0 [ (color_black, 2, [3,4] ++ [22,27] ) ]

-- 46edo.6right.5downright.2-vert-2-horiz.ltn
-- PITFALL: For this to be readable I need rainbow 7:6s,
-- i.e. in Colors.hs there should be a passage like
-- (46, rainbow 46 9 46 0)
go 46 6 5 0 0 [ (color_black, 2, [5,10] ++ [30,36] ) ]

:{
go 46 4   11  01 00 -- 46edo.4right.11downright.+1notes.2-vert-2-horiz.ltn
  [ (color_black, 2, [6,11])  -- a vertical pair
  , (color_black, 3, [19,20]) -- a horizontal pair
  ]
:}

:{
-- 48edo.5right.9downright.white-2-by-3-block.ltn
-- TODO : try this with a rainbow spacing of 18\48 (450 cents).
go 48 5 9 0 0 [ (color_white, 3, [
  49,45,39, -- a vertical row
  51,47,41
  ] ) ]
:}

-- 50edo.6right.1down.rainbow.2-horiz-2-vert.ltn
go 50 6 7 0 0 [ (color_white, 2, [4,5] ++ [29,30] ) ]

-- 50edo.8right.5downright.rainbow.3-white.ltn
go 50 8   05  0  0 [ (color_white, 2, [16,27,38] ) ]

go 50 8   05  00 00 [] []
go 50 8   05  20 00 [] []

:{
go 53 7 4 00 00 -- 53edo.7right.4downright.2-horiz-2-vert.ltn
  [ -- copied from 46-edo "2-edge-1-center" above
    (color_black, 2, [0,2])  -- a down-right pair
  , (color_black, 3, [23,24]) -- a horizontal pair
  ]
:}

go 53 9   04  00 00 [] [] -- Bosanquet
go 53 9   04  11 01 [] []

:{
-- PITFALL: Best with a rainbow cycle of length 29 = 58 / 2.
--go 58 8   05  04 00 -- 58edo.8right.5downright.solid-triangles.+4.ltn
  go 58 8   05  00 00 -- 58edo.8right.5downright.solid-triangles.ltn
  [ (color_white, 1, [ 17, 30 ] )     -- F, G
  , (color_white, 1, [ 28, 29, 39, 40, 41, 42 ] ) -- the entire triangle except its upper-right edge
  , (color_white, 2, [ 25, 50 ] )     -- A, C#
  ]
:}


-- PITFALL: Best with a rainbow cycle of length 29 = 58 / 2.
--go 58 8   05  04 00 -- 58edo.8right.5downright.triangles.+4.ltn
  go 58 8   05  00 00 -- 58edo.8right.5downright.triangles.ltn
  [ (color_white, 1, [ 17, 30 ] )     -- F, G
  , (color_white, 1, [ 28, 39, 41 ] ) -- the lower left side of the triangle
  , (color_white, 2, [ 25, 50 ] )     -- A, C#
  ]
:}


:{
-- PITFALL: Best with a rainbow cycle of length 29 = 58 / 2.
--go 58 8   05  04 00 -- 58edo.8right.5downright.white-zigzag.+4.ltn
go 58 8   05  00 00 -- 58edo.8right.5downright.white-zigzag.ltn
  [ (color_white, 1, [ 17, 30 ] )     -- F, G
  , (color_white, 1, [ 28, 39 ] )     -- vertical-ish, down from board 1 key 17 to board 2 key 50
  , (color_white, 2, [ 25, 38, 50 ] ) -- A, B, C#
  ]
:}

:{
-- PITFALL: Best with a rainbow cycle of length 29 = 58 / 2.
-- 58edo.8right.5downright.4-white-2-gray.ltn
--go 58 8   05  04 00
go 58 8   05  00 00
  [ (color_white, 1, [ 17, 30 ] )     -- F, G
  , (color_white, 2, [ 25, 38 ] )     -- A, B
  , (color_gray,  2, [ 15, 41 ] )     -- C, E (28 would be D)
  ]
:}

-- 58edo.5right.14downright.color-17.black-2h-2v.ltn
go 58 5   14  00 00 [ (color_black, 2, [7,13, 39,40] ) ]

go 60 5   07  00 00 [] []
go 60 7   09  00 00 [] []
```

# A picture of the note names

~/many-small/music-making/lumatone/2022-08-27-stl4uf7J.one-lumatone-octave.png

Note that it LIES due to an off-by-one error.
